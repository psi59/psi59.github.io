---
title: "[Real MySQL 8.0] 2장. 설치와 설정"
tags: ["mysql"]
draft: true
date: 2021-11-29T23:54:00+09:00
---

## MySQL 서버 폴더 구조

- bin: 서버와 클라이언트, 유틸리티를 위한 디렉토리
- include: C/C++ 헤더 파일들이 저장된 디렉토리
- lib: 라이브러리 파일들이 저장된 디렉토리
- share: 다양한 지원 파일들이 저장되어 있으며, 에러 메시지나 샘플 설정 파일이 디렉토리

## 시작과 종료

### 서비스 시작, 종료 및 상태 확인

```bash
# 시작
systemctl start mysqld
# 종료
systemctl stop mysqld
# 상태 확인
systemctl status mysqld
```

### 원격으로 SHUTDOWN

MySQL을 원격으로 종료하기 위해서는 MySQL에 로그인 한 상태에서 `SHUTDOWN` 명령어를 실행하면 된다. 

원격으로 SHUTDOWN 하기 위해서는 계정이 SHUTDOWN 권한을 가지고 있어야 한다.

```mysql
SHUTDOWN
```

MySQL 서버가 종료될 때 모든 커밋된 내용을 데이터 파일에 기록하고 종료하게 하기 위해서는 서버의 옵션을 변경하고 종료하면 된다.
커밋된 데이터를 데이터 파일에 적용하고 종료하는 것을 클린 셧다운(clean shutdown)이라고 한다.

```bash
mysql> SET GLOBAL innodb_fast_shutdown=0;
linux> systemctl stop mysqld

## 또는 
mysql> SET GLOBAL innodb_fast_shutdown=0;
mysql> SHUTDOWN;
```

## 서버 연결 테스트

```bash
## 1. 소켓 파일을 이용해 접속
mysql -uroot -p --host=localhost --socket=/tmp/mysql.sock
## 2. TCP/IP를 통해 접속
mysql -uroot -p --host=127.0.0.1 --port=3306
## 3. 주소와 포트를 명시하지 않고 접속
mysql -uroot -p
```

MySQL 서버에 접속할 때는 호스트를 `localhost`로 명시하는 것과 `127.0.0.1`로 명시하는 것이 각각 의미가 다르다.
`localhost`는 항상 **소켓 파일**을 통해 접속, `127.0.0.1`은 **TCP/IP 통신** 방식을 사용한다.
주소와 포트를 명시하지 않고 접속하는 경우에는 호스트는 `localhost`가 되며 소켓 파일을 사용하게 되는데, 소켓 파일의 위치는 MySQL 서버의 설정 파일에서 읽어서 사용한다.

## MySQL 서버 업그레이드

서버를 업그레이드 하는 방법으로 두 가지 방법을 생각해볼 수 있다.

1. 인플레이스 업그레이드(In-Place Upgrade): 데이터 파일은 그대로 두고 업그레이드 하는 방법
   - 인플레이스 업그레이드는 여러 가지 제약 사항이 있지만 업그레이드 시간을 크게 단축할 수 있다.
2. 논리적 업그레이드(Logical Upgrade): 서버의 데이터를 SQL나 텍스트 파일로 덤프한 후 새로 업그레이된 버전의 MySQL 서버에서 덤프된 데이터를 load 하는 방법
   - 논리적 업그레이드는 버전 간 제약 사항이 거의 없지만 데이터 양에 따라 시간이 매우 많이 소요될 수 있다.

### 인플레이스 업그레이드 제약 사항
1. 마이너 버전 간 업그레이드는 대부분 데이터 파일의 변경 없이 진행되며, 많은 경우 여러 버전을 건너뛰어서 업그레이드하는 것도 허용된다.
2. 메이저 버전 간 업그레이드 크고 작은 데이터 파일의 변경이 필요하기 때문에 반드시 직전 버전에서만 업그레이드가 허용된다. 예를 들어 `5.5` 버전에서 `5.6` 버전으로 업그레이드는 가능하지만 `5.5` 버전에서 `5.7` 버전으로 업그레이드는 지원하지 않는다.
    - 메이저 버전은 직전 버전에서 사용하던 데이터 파일과 로그 포멧만 인식하도록 구현되기 때문이다.
3. 메이저 버전의 업그레이드가 특정 마이너 버전에서만 가능한 경우가 있다.
    - `5.7.8` 버전을 사용 중이라면 `8.0`으로 바로 업그레이드 할 수 없다. `5.7.8` 버전이 GA(General Availability) 버전이 아니기 때문이다.


|test|hello|
