<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Let's Encrypt 와일드카드 인증서 발급해보기 | Realsangil</title>
<meta name=keywords content="https,letsencrypt">
<meta name=description content="Let's Encrypt 와일드카드 인증서 발급해보기 - Realsangil">
<meta name=author content="박상일">
<link rel=canonical href=https://blog.realsangil.net/posts/2018-08-04-letsencrypt-wildcard-certification/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.realsangil.net/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://blog.realsangil.net/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://blog.realsangil.net/favicon-32x32.png>
<link rel=apple-touch-icon href=https://blog.realsangil.net/apple-touch-icon.png>
<link rel=mask-icon href=https://blog.realsangil.net/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.91.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MMTYEB98J6"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-MMTYEB98J6',{anonymize_ip:!1})}</script>
<meta property="og:title" content="Let's Encrypt 와일드카드 인증서 발급해보기">
<meta property="og:description" content>
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.realsangil.net/posts/2018-08-04-letsencrypt-wildcard-certification/">
<meta property="og:image" content="https://blog.realsangil.net/images/covers/letsencrypt.jpg"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-08-04T11:41:00+09:00">
<meta property="article:modified_time" content="2018-08-04T11:41:00+09:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.realsangil.net/images/covers/letsencrypt.jpg">
<meta name=twitter:title content="Let's Encrypt 와일드카드 인증서 발급해보기">
<meta name=twitter:description content>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.realsangil.net/posts/"},{"@type":"ListItem","position":3,"name":"Let's Encrypt 와일드카드 인증서 발급해보기","item":"https://blog.realsangil.net/posts/2018-08-04-letsencrypt-wildcard-certification/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Let's Encrypt 와일드카드 인증서 발급해보기","name":"Let\u0027s Encrypt 와일드카드 인증서 발급해보기","description":"","keywords":["https","letsencrypt"],"articleBody":"이번 포스트에서는 Let’s Encrypt에서 wildcard 인증서를 발급받는 방법을 포스팅해보려 합니다.\n들어가기 앞서 서브 도메인과 wildcard 인증서에 대해서 간단히 설명드리고 시작하겠습니다.\nSub Domain이란? 일반적인 도메인들은 www.lalaworks.com의 포멧으로 이뤄져 있습니다.\n여기서 com은 Top Level Domain (TLD), lalaworks는 Second Level Domain (SLD), www는 Subdomain 이라 칭합니다.\nSubdomain은 보조 도메인으로서 기억하기 쉬운 도메인 주소를 만들어 줄 뿐만 아니라 성격이 다른 서비스를 구분할 수 있도록 해주는 역할을 합니다.\nWildcard 인증서란? 일반적인 인증서는 인증서당 하나의 도메인만 적용할 수 있습니다. 예를 들면 www.lalaworks.com의 도메인으로 발급한 인증서는 example.lalaworks.com의 도메인에서는 www.lalaworks.com로 발급한 인증서를 사용할 수 없습니다. 일반적인 인증서는 각각의 도메인마다 발급받아야 한다는 단점이 있습니다. 이러한 단점을 해결하기 위해 만들어진 것이 Wildcard 인증서인데요. Wildcard 인증서는 lalaworks.com의 이름을 가진 모든 도메인에서 사용할 수 있는 인증서 입니다.\n발급받기 주의: certbot에서 아직 aws는 실험적으로 지원하고 있으므로 기존에 사용하고 계시던 인증서는 반드시 백업해주시기 바랍니다.\n이 포스트에서는 AWS Instance를 기준으로 설명드릴 것이며 redhat계열의 리눅스는 거의 동일할 것이며, debian계열에서는 git을 설치하는 과정만 다를것이며 나머지 방법은 동일합니다.\n제가 사용하고 있는 인스턴스의 OS의 정보는 아래와 같습니다.\n/etc/os-release:NAME=\"Amazon Linux AMI\" /etc/os-release:VERSION=\"2018.03\" /etc/os-release:ID=\"amzn\" /etc/os-release:ID_LIKE=\"rhel fedora\" /etc/os-release:VERSION_ID=\"2018.03\" /etc/os-release:PRETTY_NAME=\"Amazon Linux AMI 2018.03\" /etc/os-release:ANSI_COLOR=\"0;33\" /etc/os-release:CPE_NAME=\"cpe:/o:amazon:linux:2018.03:ga\" /etc/os-release:HOME_URL=\"http://aws.amazon.com/amazon-linux-ami/\" certbot clone 받기 # clone 받기 위해 git 설치 yum install -y git git clone https://github.com/certbot/certbot.git cd /path/to/certbot 발급 Command ./certbot-auto certonly \\ --manual \\ --preferred-challenges=dns \\ --email  \\ --server https://acme-v02.api.letsencrypt.org/directory \\ --agree-tos \\ --debug \\ --no-bootstrap \\ -d yourdomain.com \\ -d *.yourdomain.com 위의 command를 보시면 아시겠지만 yourdomain.com, *.yourdomain.com 두 개의 도메인을 입력해주셔야 합니다.\n저는 lalaworks.com라는 도메인으로 한번 발급받아 보겠습니다.\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Would you be willing to share your email address with the Electronic Frontier Foundation, a founding partner of the Let's Encrypt project and the non-profit organization that develops Certbot? We'd like to send you email about our work encrypting the web, EFF news, campaigns, and ways to support digital freedom. - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - (Y)es/(N)o: N 명령어를 입력하면 이메일로 let’s encrypt의 소식을 받을 것이냐고 묻는데 이건 각자의 기호에 따라 동의하시거나 거절하시면 됩니다.\nNOTE: The IP of this machine will be publicly logged as having requested this certificate. If you're running certbot in manual mode on a machine that is not your server, please ensure you're okay with that. Are you OK with your IP being logged? - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - (Y)es/(N)o: Y 그 다음은 인증서를 발급할 머신의 IP를 기록해도 될 것이냐고 묻는데 거절하시면 반드시 동의해야 한다는 문구가 나오므로 동의하시고 넘어가시면 됩니다.\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Please deploy a DNS TXT record under the name _acme-challenge.lalaworks.com with the following value: XXXXXXXXXXXXXXXXXXXXXXXX Before continuing, verify the record is deployed. - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Press Enter to Continue - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Please deploy a DNS TXT record under the name _acme-challenge.lalaworks.com with the following value: XXXXXXXXXXXXXXXXXXXXXXXX Before continuing, verify the record is deployed. - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Press Enter to Continue DNS에 레코드를 등록하지 않고 바로 Enter를 입력하시면 레코드가 없는 상태에서 인증을 시도하기 때문에 반드시 DNS에 레코드를 등록하신 후에 다음으로 진행해주세요.\n위의 메시지를 보시면 DNS에 _acme-challenge.lalaworks.com라는 이름으로 TXT레코드를 등록해달라고 하네요 앞서 말씀드렸다 싶이 저는 AWS를 사용중이므로 Route 53에 이걸 등록해보도록 하겠습니다.\n사진과 같이 위의 커맨드라인에서 XXXXXXXXXXXXXXXXXXXXXXXX 위치에 나온 값 2개를 등록해 주세요.\n참고로 Route 53에서는 newline으로 값을 구분하며 ““으로 값을 묶어주시면 됩니다.\n레코드를 등록하셨다면 레코드에 요청을 했을 때 정상적으로 입력한 값들이 내려오는지 한번 확인해 본 후에 진행하는것을 추천드립니다. Route 53에서 레코드를 테스트할 때는 Test Recode Set이라는 버튼을 눌러주세요.\n위의 사진과 같이 Reccord name에 _acme-challenge를 입력해주시고 Type을 TXT로 바꿔주신 후에 Get response를 눌러주시고 값을 확인한 후 다음으로 진행하시면 됩니다.\nWaiting for verification... Cleaning up challenges IMPORTANT NOTES: - Congratulations! Your certificate and chain have been saved at: /etc/letsencrypt/live/lalaworks.com/fullchain.pem Your key file has been saved at: /etc/letsencrypt/live/lalaworks.com/privkey.pem Your cert will expire on 2018-11-02. To obtain a new or tweaked version of this certificate in the future, simply run certbot-auto again. To non-interactively renew *all* of your certificates, run \"certbot-auto renew\" - If you like Certbot, please consider supporting our work by: Donating to ISRG / Let's Encrypt: https://letsencrypt.org/donate Donating to EFF: https://eff.org/donate-le 다시 Terminal로 돌아와서 Enter를 눌러주신 후 성공적으로 인증을 마쳤다면 위의 메시지가 보이는데 간단히 말씀드리면 /etc/letsencrypt/live/lalaworks.com/fullchain.pem, /etc/letsencrypt/live/lalaworks.com/privkey.pem에 발급받은 키들이 저장되었다는걸 알 수 있으며 만료일은 세 달 뒤인 2018-11-02이며 certbot-auto renew의 커맨드로 갱신할 수 있다고 하네요 ㅎㅎ 친절한 CertBot씨\n./certbot-auto certificates 커맨드로 제대로 발급되었는지 확인해볼 수 있습니다.\nSaving debug log to /var/log/letsencrypt/letsencrypt.log - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Found the following certs: Certificate Name: lalaworks.com Domains: lalaworks.com *.lalaworks.com Expiry Date: 2018-11-02 02:08:26+00:00 (VALID: 89 days) Certificate Path: /etc/letsencrypt/live/lalaworks.com/fullchain.pem Private Key Path: /etc/letsencrypt/live/lalaworks.com/privkey.pem - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 적용하는 부분은 Let’s Encrypt로 https 서비스 하기를 참고하시면 될거 같습니다.\nConclusion 인증서를 발급받으면서 간단하게 도메인 구조에 대해서도 다시 공부하게 됐고 인증서도 발급받고 아주 유익한 시간이었습니다. 위의 과정은 어디까지나 참고하시는 사항이고 저와 환경이 같지 않다면 저 흐름에서 크게 벗어나지는 않겠지만 조금은 다를 것입니다.\n대부분의 let’s encrypt 사용자가 사용하시겠지만은 팁을 드리자면 crontab에 주기적으로 갱신스크립트를 호출하는 스케쥴을 등록하시면 매번 직접 갱신하지 않으셔도 자동으로 갱신된다는 아주 꾸르팁!!\n궁금하신 사항이나 잘못된 정보가 있다면 댓글이나 tkddlf59@gmail.com으로 메일 주시기 바랍니다.\nReferences  https://kr.godaddy.com/help/what-is-a-subdomain-296 ","wordCount":"1117","inLanguage":"en","image":"https://blog.realsangil.net/images/covers/letsencrypt.jpg","datePublished":"2018-08-04T11:41:00+09:00","dateModified":"2018-08-04T11:41:00+09:00","author":{"@type":"Person","name":"박상일"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.realsangil.net/posts/2018-08-04-letsencrypt-wildcard-certification/"},"publisher":{"@type":"Organization","name":"Realsangil","logo":{"@type":"ImageObject","url":"https://blog.realsangil.net/favicon.ico"}}}</script>
</head>
<body id=top>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://blog.realsangil.net accesskey=h title="Realsangil (Alt + H)">Realsangil</a>
<span class=logo-switches>
</span>
</div>
<ul id=menu>
<li>
<a href=https://blog.realsangil.net/posts/ title=posts>
<span>posts</span>
</a>
</li>
<li>
<a href=https://blog.realsangil.net/tags/ title=tags>
<span>tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://blog.realsangil.net>Home</a>&nbsp;»&nbsp;<a href=https://blog.realsangil.net/posts/>Posts</a></div>
<h1 class=post-title>
Let's Encrypt 와일드카드 인증서 발급해보기
</h1>
<div class=post-meta><span title="2018-08-04 11:41:00 +0900 +0900">August 4, 2018</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;박상일
</div>
</header>
<figure class=entry-cover><img loading=lazy src=https://blog.realsangil.net/images/covers/letsencrypt.jpg alt>
</figure><div class=toc>
<details open>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#sub-domain%ec%9d%b4%eb%9e%80 aria-label="Sub Domain이란?">Sub Domain이란?</a></li>
<li>
<a href=#wildcard-%ec%9d%b8%ec%a6%9d%ec%84%9c%eb%9e%80 aria-label="Wildcard 인증서란?">Wildcard 인증서란?</a></li>
<li>
<a href=#%eb%b0%9c%ea%b8%89%eb%b0%9b%ea%b8%b0 aria-label=발급받기>발급받기</a><ul>
<li>
<a href=#certbot-clone-%eb%b0%9b%ea%b8%b0 aria-label="certbot clone 받기">certbot clone 받기</a></li>
<li>
<a href=#%eb%b0%9c%ea%b8%89-command aria-label="발급 Command">발급 Command</a></li></ul>
</li>
<li>
<a href=#conclusion aria-label=Conclusion>Conclusion</a></li>
<li>
<a href=#references aria-label=References>References</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><p>이번 포스트에서는 Let&rsquo;s Encrypt에서 wildcard 인증서를 발급받는 방법을 포스팅해보려 합니다.<br>
들어가기 앞서 서브 도메인과 wildcard 인증서에 대해서 간단히 설명드리고 시작하겠습니다.</p>
<h2 id=sub-domain이란>Sub Domain이란?<a hidden class=anchor aria-hidden=true href=#sub-domain이란>#</a></h2>
<p>일반적인 도메인들은 <code>www.lalaworks.com</code>의 포멧으로 이뤄져 있습니다.<br>
여기서 <code>com</code>은 <em>Top Level Domain (TLD)</em>, <code>lalaworks</code>는 <em>Second Level Domain (SLD)</em>, <code>www</code>는 <em>Subdomain</em> 이라 칭합니다.<br>
<strong>Subdomain</strong>은 보조 도메인으로서 기억하기 쉬운 도메인 주소를 만들어 줄 뿐만 아니라 성격이 다른 서비스를 구분할 수 있도록 해주는 역할을 합니다.</p>
<h2 id=wildcard-인증서란>Wildcard 인증서란?<a hidden class=anchor aria-hidden=true href=#wildcard-인증서란>#</a></h2>
<p>일반적인 인증서는 인증서당 하나의 도메인만 적용할 수 있습니다. 예를 들면 <code>www.lalaworks.com</code>의 도메인으로 발급한 인증서는 <code>example.lalaworks.com</code>의 도메인에서는 <code>www.lalaworks.com</code>로 발급한 인증서를 사용할 수 없습니다. 일반적인 인증서는 각각의 도메인마다 발급받아야 한다는 단점이 있습니다. 이러한 단점을 해결하기 위해 만들어진 것이 Wildcard 인증서인데요. Wildcard 인증서는 <code>lalaworks.com</code>의 이름을 가진 모든 도메인에서 사용할 수 있는 인증서 입니다.</p>
<h2 id=발급받기>발급받기<a hidden class=anchor aria-hidden=true href=#발급받기>#</a></h2>
<p><strong>주의: certbot에서 아직 aws는 실험적으로 지원하고 있으므로 기존에 사용하고 계시던 인증서는 반드시 백업해주시기 바랍니다.</strong></p>
<p>이 포스트에서는 AWS Instance를 기준으로 설명드릴 것이며 redhat계열의 리눅스는 거의 동일할 것이며, debian계열에서는 <code>git</code>을 설치하는 과정만 다를것이며 나머지 방법은 동일합니다.</p>
<p>제가 사용하고 있는 인스턴스의 OS의 정보는 아래와 같습니다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>/etc/os-release:NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Amazon Linux AMI&#34;</span>
/etc/os-release:VERSION<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2018.03&#34;</span>
/etc/os-release:ID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;amzn&#34;</span>
/etc/os-release:ID_LIKE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;rhel fedora&#34;</span>
/etc/os-release:VERSION_ID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2018.03&#34;</span>
/etc/os-release:PRETTY_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Amazon Linux AMI 2018.03&#34;</span>
/etc/os-release:ANSI_COLOR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0;33&#34;</span>
/etc/os-release:CPE_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cpe:/o:amazon:linux:2018.03:ga&#34;</span>
/etc/os-release:HOME_URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://aws.amazon.com/amazon-linux-ami/&#34;</span>
</code></pre></div><h3 id=certbot-clone-받기>certbot clone 받기<a hidden class=anchor aria-hidden=true href=#certbot-clone-받기>#</a></h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># clone 받기 위해 git 설치</span>
yum install -y git
git clone https://github.com/certbot/certbot.git
cd /path/to/certbot
</code></pre></div><h3 id=발급-command>발급 Command<a hidden class=anchor aria-hidden=true href=#발급-command>#</a></h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>./certbot-auto certonly <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--manual <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--preferred-challenges<span style=color:#f92672>=</span>dns <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--email &lt;you@email.com&gt; <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--server https://acme-v02.api.letsencrypt.org/directory <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--agree-tos <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--debug <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--no-bootstrap <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-d yourdomain.com <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-d *.yourdomain.com
</code></pre></div><p>위의 command를 보시면 아시겠지만 <code>yourdomain.com</code>, <code>*.yourdomain.com</code> 두 개의 도메인을 입력해주셔야 합니다.</p>
<p>저는 <code>lalaworks.com</code>라는 도메인으로 한번 발급받아 보겠습니다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Would you be willing to share your email address with the Electronic Frontier
Foundation, a founding partner of the Let<span style=color:#e6db74>&#39;s Encrypt project and the non-profit
</span><span style=color:#e6db74>organization that develops Certbot? We&#39;</span>d like to send you email about our work
encrypting the web, EFF news, campaigns, and ways to support digital freedom.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
<span style=color:#f92672>(</span>Y<span style=color:#f92672>)</span>es/<span style=color:#f92672>(</span>N<span style=color:#f92672>)</span>o: N
</code></pre></div><p>명령어를 입력하면 이메일로 let&rsquo;s encrypt의 소식을 받을 것이냐고 묻는데 이건 각자의 기호에 따라 동의하시거나 거절하시면 됩니다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>NOTE: The IP of this machine will be publicly logged as having requested this
certificate. If you<span style=color:#e6db74>&#39;re running certbot in manual mode on a machine that is not
</span><span style=color:#e6db74>your server, please ensure you&#39;</span>re okay with that.

Are you OK with your IP being logged?
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
<span style=color:#f92672>(</span>Y<span style=color:#f92672>)</span>es/<span style=color:#f92672>(</span>N<span style=color:#f92672>)</span>o: Y
</code></pre></div><p>그 다음은 인증서를 발급할 머신의 IP를 기록해도 될 것이냐고 묻는데 거절하시면 반드시 동의해야 한다는 문구가 나오므로 동의하시고 넘어가시면 됩니다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please deploy a DNS TXT record under the name
_acme-challenge.lalaworks.com with the following value:

XXXXXXXXXXXXXXXXXXXXXXXX

Before continuing, verify the record is deployed.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Press Enter to Continue

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please deploy a DNS TXT record under the name
_acme-challenge.lalaworks.com with the following value:

XXXXXXXXXXXXXXXXXXXXXXXX

Before continuing, verify the record is deployed.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Press Enter to Continue
</code></pre></div><p><em>DNS에 레코드를 등록하지 않고 바로 Enter를 입력하시면 레코드가 없는 상태에서 인증을 시도하기 때문에 반드시 DNS에 레코드를 등록하신 후에 다음으로 진행해주세요.</em></p>
<p>위의 메시지를 보시면 DNS에 <code>_acme-challenge.lalaworks.com</code>라는 이름으로 TXT레코드를 등록해달라고 하네요
앞서 말씀드렸다 싶이 저는 AWS를 사용중이므로 <code>Route 53</code>에 이걸 등록해보도록 하겠습니다.</p>
<p><img loading=lazy src=/images/2018-08-04-letsencrypt/create_record.png alt=Route_53_1>
</p>
<p>사진과 같이 위의 커맨드라인에서 <code>XXXXXXXXXXXXXXXXXXXXXXXX</code> 위치에 나온 값 2개를 등록해 주세요.<br>
<em>참고로 Route 53에서는 newline으로 값을 구분하며 &ldquo;&ldquo;으로 값을 묶어주시면 됩니다.</em></p>
<p>레코드를 등록하셨다면 레코드에 요청을 했을 때 정상적으로 입력한 값들이 내려오는지 한번 확인해 본 후에 진행하는것을 추천드립니다.
Route 53에서 레코드를 테스트할 때는 <code>Test Recode Set</code>이라는 버튼을 눌러주세요.</p>
<p><img loading=lazy src=/images/2018-08-04-letsencrypt/check_record_in_route53.png alt=Route_53_2>
</p>
<p>위의 사진과 같이 Reccord name에 <code>_acme-challenge</code>를 입력해주시고 Type을 <code>TXT</code>로 바꿔주신 후에 Get response를 눌러주시고 값을 확인한 후 다음으로 진행하시면 됩니다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Waiting <span style=color:#66d9ef>for</span> verification...
Cleaning up challenges

IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/lalaworks.com/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/lalaworks.com/privkey.pem
   Your cert will expire on 2018-11-02. To obtain a new or tweaked
   version of this certificate in the future, simply run certbot-auto
   again. To non-interactively renew *all* of your certificates, run
   <span style=color:#e6db74>&#34;certbot-auto renew&#34;</span>
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let<span style=color:#960050;background-color:#1e0010>&#39;</span>s Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le
</code></pre></div><p>다시 Terminal로 돌아와서 Enter를 눌러주신 후 성공적으로 인증을 마쳤다면 위의 메시지가 보이는데 간단히 말씀드리면 <code>/etc/letsencrypt/live/lalaworks.com/fullchain.pem</code>, <code>/etc/letsencrypt/live/lalaworks.com/privkey.pem</code>에 발급받은 키들이 저장되었다는걸 알 수 있으며 만료일은 세 달 뒤인 <code>2018-11-02</code>이며 <code>certbot-auto renew</code>의 커맨드로 갱신할 수 있다고 하네요 ㅎㅎ 친절한 CertBot씨</p>
<p><code>./certbot-auto certificates</code> 커맨드로 제대로 발급되었는지 확인해볼 수 있습니다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Saving debug log to /var/log/letsencrypt/letsencrypt.log

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Found the following certs:
  Certificate Name: lalaworks.com
    Domains: lalaworks.com *.lalaworks.com
    Expiry Date: 2018-11-02 02:08:26+00:00 <span style=color:#f92672>(</span>VALID: <span style=color:#ae81ff>89</span> days<span style=color:#f92672>)</span> 
    Certificate Path: /etc/letsencrypt/live/lalaworks.com/fullchain.pem
    Private Key Path: /etc/letsencrypt/live/lalaworks.com/privkey.pem
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</code></pre></div><p>적용하는 부분은 <a href=https://realsangil.github.io/http/17-03-31-letsencrypt>Let’s Encrypt로 https 서비스 하기</a>를 참고하시면 될거 같습니다.</p>
<h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2>
<p>인증서를 발급받으면서 간단하게 도메인 구조에 대해서도 다시 공부하게 됐고 인증서도 발급받고 아주 유익한 시간이었습니다.
위의 과정은 어디까지나 참고하시는 사항이고 저와 환경이 같지 않다면 저 흐름에서 크게 벗어나지는 않겠지만 조금은 다를 것입니다.</p>
<p>대부분의 let&rsquo;s encrypt 사용자가 사용하시겠지만은 팁을 드리자면 crontab에 주기적으로 갱신스크립트를 호출하는 스케쥴을 등록하시면
매번 직접 갱신하지 않으셔도 자동으로 갱신된다는 아주 꾸르팁!!</p>
<p>궁금하신 사항이나 잘못된 정보가 있다면 댓글이나 <a href=mailto:tkddlf59@gmail.com>tkddlf59@gmail.com</a>으로 메일 주시기 바랍니다.</p>
<h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2>
<ul>
<li><a href=https://kr.godaddy.com/help/what-is-a-subdomain-296>https://kr.godaddy.com/help/what-is-a-subdomain-296</a></li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://blog.realsangil.net/tags/https/>https</a></li>
<li><a href=https://blog.realsangil.net/tags/letsencrypt/>letsencrypt</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://blog.realsangil.net/posts/2018-10-31-letsencrypt-wildcard-certification-renew/>
<span class=title>« Prev Page</span>
<br>
<span>Let's Encrypt 와일드카드 인증서 갱신해보기</span>
</a>
<a class=next href=https://blog.realsangil.net/posts/2018-04-15-docker-dns-problem/>
<span class=title>Next Page »</span>
<br>
<span>Docker DNS 문제 해결하기</span>
</a>
</nav>
</footer><script src=https://utteranc.es/client.js repo=realsangil/realsangil.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://blog.realsangil.net>Realsangil</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>